rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Publicly readable collections
    match /projects/{docId} {
      allow read: if true;
      allow write: if hasAdmin();
    }

    match /techStack/{docId} {
      allow read: if true;
      allow write: if hasAdmin();
    }

    match /about/{docId} {
      allow read: if true;
      allow write: if hasAdmin();
    }

    // Helper: check admin cookie
    function hasAdmin() {
      return request.headers.get('cookie') != null
             && request.headers.get('cookie').contains('admin_token=authenticated');
    }
  }
}